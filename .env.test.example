# =============================================================================
# INTEGRATION TESTS ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env.test and configure values for integration testing
# Integration tests use LOCAL DOCKER DATABASE but REAL SANDBOX INTEGRATORS
# =============================================================================

# -----------------------------------------------------------------------------
# ENVIRONMENT
# -----------------------------------------------------------------------------
NODE_ENV=test

# -----------------------------------------------------------------------------
# SERVER CONFIGURATION
# -----------------------------------------------------------------------------
WALLET_SERVER_PORT=3000
WALLET_SERVER_URL=http://localhost:3000
WALLET_SERVER_DOMAIN=localhost
WALLET_SERVER_MAIL_FROM=noreply@test.local
WALLET_JOB_KEY=test_job_key_xxxx
WALLET_LOGO_IMAGE_ULR=https://example.com/logo.png

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION (LOCAL DOCKER)
# -----------------------------------------------------------------------------
# MySQL connection for LOCAL DEVELOPMENT DATABASE (Docker)
# Using root user for full permissions (required for Prisma migrations)
WALLET_MYSQL_LOG=enable
WALLET_MYSQL_URL=mysql://root:root123@localhost:3306/unex?connection_limit=50&pool_timeout=30

# -----------------------------------------------------------------------------
# REDIS CONFIGURATION (LOCAL DOCKER)
# -----------------------------------------------------------------------------
WALLET_REDIS_URL=redis://localhost:6379/0

# -----------------------------------------------------------------------------
# JWT CONFIGURATION
# -----------------------------------------------------------------------------
WALLET_TOKEN_SECRET=test_secret_key_for_integration_tests_xxxx
WALLET_TOKEN_EXPIRE=144000

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------
# Enable mock validation codes for faster tests
ENABLE_MOCK_CODES=true

# Enable sandbox mode for testing
WALLET_SANDBOX=enable
WALLET_SANDBOX_SEND_MAIL=false
WALLET_SANDBOX_SEND_PUSH=false

# Biometric
BIOMETRIC_CHALLENGE_TTL=180

# Tasks
WALLET_TASKS=enable
WALLET_TASKS_LOG=enable

# Spending Limits
WALLET_SPENDING_LIMITS=enable
WALLET_SPENDING_LIMITS_LOG=enable

# -----------------------------------------------------------------------------
# EMAIL CONFIGURATION (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_EMAIL_KEY=AKIAXXXXXXXXXXXXXXXX
WALLET_EMAIL_PASSWORD=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_EMAIL_REGION=us-east-2

# -----------------------------------------------------------------------------
# SMS CONFIGURATION (SANDBOX CREDENTIALS - TWILIO)
# -----------------------------------------------------------------------------
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_SMS_FROM=+1234567890
TWILIO_WHATSAPP_FROM=+1234567890
TWILIO_WHATSAPP_CONTENT_SID=HXxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# FILES / S3 CONFIGURATION (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_FILES_KEY=AKIAXXXXXXXXXXXXXXXX
WALLET_FILES_PASSWORD=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_FILES_REGION=us-east-2
WALLET_FILES_BUCKET=unex-test-files
WALLET_FILES_PUBLIC_URL=https://unex-test-files.s3.us-east-2.amazonaws.com

# -----------------------------------------------------------------------------
# EXPO PUSH NOTIFICATIONS (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_EXPO_PUSH_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS BIND - CVU PROVIDER (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_BIND=enable
WALLET_BIND_LOG=enable
WALLET_BIND_PROXY=enable
WALLET_BIND_URL=https://api-sandbox.bind.example.com
WALLET_BIND_USERNAME=api-test-user
WALLET_BIND_PASSWORD=xxxxxxxxxxxxxxxxxxxxxxxx
WALLET_BIND_CRT=bind_test.crt
WALLET_BIND_KEY=bind_test.key
WALLET_BIND_PASSPHRASE=test_passphrase_xxxx
WALLET_BIND_ACCOUNT=20-1-000000-1-5
WALLET_BIND_WEBHOOK_SECRET=bind_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS CRONOS - PIX PROVIDER (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_CRONOS=enable
WALLET_CRONOS_LOG=enable
WALLET_CRONOS_PROXY=enable
WALLET_CRONOS_URL=https://stage.cronos.example.com
WALLET_CRONOS_USERNAME=pub_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_CRONOS_PASSWORD=priv_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_CRONOS_USER_PASSWORD=test_password_xxxx
WALLET_CRONOS_WEBHOOK_SECRET=cronos_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS MANTECA - CRYPTO PROVIDER (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_MANTECA=enable
WALLET_MANTECA_LOG=enable
WALLET_MANTECA_PROXY=enable
WALLET_MANTECA_URL=https://sandbox.manteca.example.com/crypto
WALLET_MANTECA_KEY=XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX
WALLET_MANTECA_RATE_TTL=60
WALLET_MANTECA_WEBHOOK_REQUEST_IP=1.2.3.4
WALLET_MANTECA_WEBHOOK_REQUEST_SECRET=manteca_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS GIRE - RAPIPAGO PROVIDER (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_GIRE=enable
WALLET_GIRE_LOG=enable
WALLET_GIRE_URL=https://services-sandbox.gire.example.com/rapipago/testing
WALLET_GIRE_ID=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_GIRE_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_GIRE_PROVINCE=CAPITAL FEDERAL
WALLET_GIRE_WEBHOOK_SECRET=gire_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS POMELO - CARD PROVIDER (SANDBOX CREDENTIALS - DISABLED BY DEFAULT)
# -----------------------------------------------------------------------------
WALLET_POMELO=disable
WALLET_POMELO_LOG=enable
WALLET_POMELO_URL=https://api-sandbox.pomelo.example.com
WALLET_POMELO_ID=xxxxxxxxxxxxxxxxxxxxxx
WALLET_POMELO_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_POMELO_AUDIENCE=https://auth-sandbox.pomelo.example.com
WALLET_POMELO_AFFINITY_GROUP=afg-xxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_POMELO_API_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_POMELO_SECRET_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WALLET_POMELO_WHITELISTED_IP=1.2.3.4,5.6.7.8
WALLET_POMELO_IDENTITY_URL=https://identity-sandbox.pomelo.example.com

# -----------------------------------------------------------------------------
# WS VALIDA - BIOMETRIC VERIFICATION (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_VALIDA=enable
WALLET_VALIDA_LOG=enable
WALLET_VALIDA_URL=https://valida-sandbox.example.com/api
WALLET_VALIDA_USERNAME=api@test.local
WALLET_VALIDA_PASSWORD=xxxxxxxxxxxxxxxx
WALLET_VALIDA_THEME=default
WALLET_VALIDA_WEBHOOK_SECRET=valida_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS RENAPER - IDENTITY VERIFICATION (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_RENAPER=enable
WALLET_RENAPER_LOG=enable
WALLET_RENAPER_PROXY=enable
WALLET_RENAPER_URL=https://api-sandbox.renaper.example.com
WALLET_RENAPER_VIGENCIA_USER=test_vigencia_user
WALLET_RENAPER_VIGENCIA_PASSWORD=xxxxxxxxxxxxxxxx
WALLET_RENAPER_FACIAL_USER=test_facial_user
WALLET_RENAPER_FACIAL_PASSWORD=xxxxxxxxxxxxxxxx
WALLET_RENAPER_HUELLA_USER=test_huella_user
WALLET_RENAPER_HUELLA_PASSWORD=xxxxxxxxxxxxxxxx
WALLET_RENAPER_MIN_CONFIDENCE=0.85
WALLET_RENAPER_TIMEOUT=30000
WALLET_RENAPER_WEBHOOK_SECRET=renaper_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS MOBBEX (SANDBOX CREDENTIALS - DISABLED BY DEFAULT)
# -----------------------------------------------------------------------------
WALLET_MOBBEX=disable
WALLET_MOBBEX_LOG=enable
WALLET_MOBBEX_TEST=disable

# -----------------------------------------------------------------------------
# WS COELSA - QR INTEROPERABILITY (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
WALLET_COELSA=enable
WALLET_COELSA_LOG=enable
WALLET_COELSA_PROXY=enable
WALLET_COELSA_AUTH_URL=https://sandbox-auth.coelsa.example.com/auth
WALLET_COELSA_CER=coelsa_test.cer
WALLET_COELSA_KEY=coelsa_test.key
WALLET_COELSA_PASSPHRASE=xxxxxxxxxxxxxxxx
WALLET_COELSA_DEBIN_URL=https://sandbox-debin.coelsa.example.com
WALLET_COELSA_DEBIN_USERNAME=test_debin_user
WALLET_COELSA_DEBIN_PASSWORD=xxxxxxxxxxxxxxxx
WALLET_COELSA_DEBIN_ID=xxxxxxxxxxxxxxxxxxxxxx
WALLET_COELSA_DEBIN_SECRET=xxxxxxxxxxxxxxxxxxxxxx
WALLET_COELSA_CVU_URL=https://sandbox-cvu.coelsa.example.com
WALLET_COELSA_CVU_USERNAME=test_cvu_user
WALLET_COELSA_CVU_PASSWORD=xxxxxxxxxxxxxxxx
WALLET_COELSA_CVU_ID=xxxxxxxxxxxxxxxxxxxxxx
WALLET_COELSA_CVU_SECRET=xxxxxxxxxxxxxxxxxxxxxx
WALLET_COELSA_PSP_ID=753
WALLET_COELSA_WALLET_ID=20240904
WALLET_COELSA_QRI_DOMAIN=com.unex.test
WALLET_COELSA_WEBHOOK_SECRET=coelsa_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS UNEX (INTERNAL)
# -----------------------------------------------------------------------------
WALLET_UNEX=enable
WALLET_UNEX_LOG=enable
WALLET_UNEX_WEBHOOK_SECRET=unex_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# WS MICRONAUTA (SANDBOX CREDENTIALS - DISABLED BY DEFAULT)
# -----------------------------------------------------------------------------
WALLET_MICRONAUTA=disable
WALLET_MICRONAUTA_LOG=enable
WALLET_MICRONAUTA_URL=https://sandbox.micronauta.example.com/megaweb/soap/server.php
WALLET_MICRONAUTA_USERNAME=test_user
WALLET_MICRONAUTA_PASSWORD=xxxxxxxxxxxxxxxx
WALLET_MICRONAUTA_WALLET_ID=1
WALLET_MICRONAUTA_CATEGORY_ID=29
WALLET_MICRONAUTA_WEBHOOK_SECRET=micronauta_webhook_secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# AWS SQS (SANDBOX CREDENTIALS)
# -----------------------------------------------------------------------------
AWS_REGION=us-east-2
SQS_TRANSACTIONS_QUEUE_URL=https://sqs.us-east-2.amazonaws.com/000000000000/transactions-queue-test

# =============================================================================
# INTEGRATION TEST SETUP
# =============================================================================
# 1. Start Docker containers: docker-compose up -d
# 2. Setup database: WALLET_MYSQL_URL="mysql://root:root123@localhost:3306/unex" npx prisma db push
# 3. Copy this file: cp .env.test.example .env.test
# 4. Configure .env.test with REAL sandbox credentials for external integrators
# 5. Run API server: npm run start:dev (API runs in Docker)
# 6. Run integration tests: npm run test:integration
#
# IMPORTANT:
# - Uses LOCAL Docker database (not remote sandbox DB)
# - .env.test.example has MOCK values (committed to git)
# - .env.test has REAL sandbox credentials (NOT committed to git)
# - Replace all xxxx values in .env.test with real sandbox credentials
# =============================================================================
